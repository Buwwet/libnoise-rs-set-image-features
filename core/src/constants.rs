pub(crate) const R_SQUARED: f64 = 0.5;

pub(crate) const PERMUTATION_TABLE_SIZE: usize = 256;

pub(crate) const NORMALIZATION_FACTOR_1D: f64 = 13.591804446852795;
pub(crate) const GRADIENT_LUT_1D_SIZE: usize = 16;
pub(crate) const GRADIENT_LUT_1D: [f64; 16] = [
    -8.0, -7.0, -6.0, -5.0, -4.0, -3.0, -2.0, -1.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0,
];

pub(crate) const SKEW_FACTOR_2D: f64 = 0.3660254037844386;
pub(crate) const UNSKEW_FACTOR_2D: f64 = 0.21132486540518713;
pub(crate) const NORMALIZATION_FACTOR_2D: f64 = 99.83685446303647;
pub(crate) const GRADIENT_LUT_2D_SIZE: usize = 4;
pub(crate) const GRADIENT_LUT_2D: [[f64; 2]; 4] =
    [[0.0, -1.0], [-1.0, 0.0], [0.0, 1.0], [1.0, 0.0]];

pub(crate) const SKEW_FACTOR_3D: f64 = 0.3333333333333333;
pub(crate) const UNSKEW_FACTOR_3D: f64 = 0.16666666666666666;
pub(crate) const NORMALIZATION_FACTOR_3D: f64 = 76.88375854620836;
pub(crate) const GRADIENT_LUT_3D_SIZE: usize = 12;
pub(crate) const GRADIENT_LUT_3D: [[f64; 3]; 12] = [
    [0.0, -1.0, -1.0],
    [-1.0, 0.0, -1.0],
    [-1.0, -1.0, 0.0],
    [0.0, 1.0, -1.0],
    [1.0, 0.0, -1.0],
    [1.0, -1.0, 0.0],
    [0.0, -1.0, 1.0],
    [-1.0, 0.0, 1.0],
    [-1.0, 1.0, 0.0],
    [0.0, 1.0, 1.0],
    [1.0, 0.0, 1.0],
    [1.0, 1.0, 0.0],
];
pub(crate) const SIMPLEX_TRAVERSAL_LUT_3D: [[usize; 6]; 8] = [
    [/*p2*/ 0, 0, 1, /*p3*/ 0, 1, 1], // 0: z > y > x
    [/*p2*/ 0, 0, 0, /*p3*/ 0, 0, 0], // 1: pad only
    [/*p2*/ 0, 1, 0, /*p3*/ 0, 1, 1], // 2: y > z > x
    [/*p2*/ 0, 1, 0, /*p3*/ 1, 1, 0], // 3: y > x > z
    [/*p2*/ 0, 0, 1, /*p3*/ 1, 0, 1], // 4: z > x > y
    [/*p2*/ 1, 0, 0, /*p3*/ 1, 0, 1], // 5: x > z > y
    [/*p2*/ 0, 0, 0, /*p3*/ 0, 0, 0], // 6: pad only
    [/*p2*/ 1, 0, 0, /*p3*/ 1, 1, 0], // 7: x > y > z
];

pub(crate) const SKEW_FACTOR_4D: f64 = 0.30901699437494745;
pub(crate) const UNSKEW_FACTOR_4D: f64 = 0.13819660112501053;
pub(crate) const NORMALIZATION_FACTOR_4D: f64 = 62.795597150623436;
pub(crate) const GRADIENT_LUT_4D_SIZE: usize = 32;
pub(crate) const GRADIENT_LUT_4D: [[f64; 4]; 32] = [
    [0.0, -1.0, -1.0, -1.0],
    [-1.0, 0.0, -1.0, -1.0],
    [-1.0, -1.0, 0.0, -1.0],
    [-1.0, -1.0, -1.0, 0.0],
    [0.0, 1.0, -1.0, -1.0],
    [1.0, 0.0, -1.0, -1.0],
    [1.0, -1.0, 0.0, -1.0],
    [1.0, -1.0, -1.0, 0.0],
    [0.0, -1.0, 1.0, -1.0],
    [-1.0, 0.0, 1.0, -1.0],
    [-1.0, 1.0, 0.0, -1.0],
    [-1.0, 1.0, -1.0, 0.0],
    [0.0, 1.0, 1.0, -1.0],
    [1.0, 0.0, 1.0, -1.0],
    [1.0, 1.0, 0.0, -1.0],
    [1.0, 1.0, -1.0, 0.0],
    [0.0, -1.0, -1.0, 1.0],
    [-1.0, 0.0, -1.0, 1.0],
    [-1.0, -1.0, 0.0, 1.0],
    [-1.0, -1.0, 1.0, 0.0],
    [0.0, 1.0, -1.0, 1.0],
    [1.0, 0.0, -1.0, 1.0],
    [1.0, -1.0, 0.0, 1.0],
    [1.0, -1.0, 1.0, 0.0],
    [0.0, -1.0, 1.0, 1.0],
    [-1.0, 0.0, 1.0, 1.0],
    [-1.0, 1.0, 0.0, 1.0],
    [-1.0, 1.0, 1.0, 0.0],
    [0.0, 1.0, 1.0, 1.0],
    [1.0, 0.0, 1.0, 1.0],
    [1.0, 1.0, 0.0, 1.0],
    [1.0, 1.0, 1.0, 0.0],
];
pub(crate) const SIMPLEX_TRAVERSAL_LUT_4D: [[usize; 12]; 64] = [
    [
        /*p2*/ 0, 0, 0, 1, /*p3*/ 0, 0, 1, 1, /*p4*/ 0, 1, 1, 1,
    ], // 00: w > z > y > x
    [
        /*p2*/ 0, 0, 1, 0, /*p3*/ 0, 0, 1, 1, /*p4*/ 0, 1, 1, 1,
    ], // 01: z > w > y > x
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 02: pad only
    [
        /*p2*/ 0, 0, 1, 0, /*p3*/ 0, 1, 1, 0, /*p4*/ 0, 1, 1, 1,
    ], // 03: z > y > w > x
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 04: pad only
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 05: pad only
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 06: pad only
    [
        /*p2*/ 0, 0, 1, 0, /*p3*/ 0, 1, 1, 0, /*p4*/ 1, 1, 1, 0,
    ], // 07: z > y > x > w
    [
        /*p2*/ 0, 0, 0, 1, /*p3*/ 0, 1, 0, 1, /*p4*/ 0, 1, 1, 1,
    ], // 08: w > y > z > x
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 09: pad only
    [
        /*p2*/ 0, 1, 0, 0, /*p3*/ 0, 1, 0, 1, /*p4*/ 0, 1, 1, 1,
    ], // 10: y > w > z > x
    [
        /*p2*/ 0, 1, 0, 0, /*p3*/ 0, 1, 1, 0, /*p4*/ 0, 1, 1, 1,
    ], // 11: y > z > w > x
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 12: pad only
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 13: pad only
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 14: pad only
    [
        /*p2*/ 0, 1, 0, 0, /*p3*/ 0, 1, 1, 0, /*p4*/ 1, 1, 1, 0,
    ], // 15: y > z > x > w
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 16: pad only
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 17: pad only
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 18: pad only
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 19: pad only
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 20: pad only
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 21: pad only
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 22: pad only
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 23: pad only
    [
        /*p2*/ 0, 0, 0, 1, /*p3*/ 0, 1, 0, 1, /*p4*/ 1, 1, 0, 1,
    ], // 24: w > y > x > z
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 25: pad only
    [
        /*p2*/ 0, 1, 0, 0, /*p3*/ 0, 1, 0, 1, /*p4*/ 1, 1, 0, 1,
    ], // 26: y > w > x > z
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 27: pad only
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 28: pad only
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 29: pad only
    [
        /*p2*/ 0, 1, 0, 0, /*p3*/ 1, 1, 0, 0, /*p4*/ 1, 1, 0, 1,
    ], // 30: y > x > w > z
    [
        /*p2*/ 0, 1, 0, 0, /*p3*/ 1, 1, 0, 0, /*p4*/ 1, 1, 1, 0,
    ], // 31: y > x > z > w
    [
        /*p2*/ 0, 0, 0, 1, /*p3*/ 0, 0, 1, 1, /*p4*/ 1, 0, 1, 1,
    ], // 32: w > z > x > y
    [
        /*p2*/ 0, 0, 1, 0, /*p3*/ 0, 0, 1, 1, /*p4*/ 1, 0, 1, 1,
    ], // 33: z > w > x > y
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 34: pad only
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 35: pad only
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 36: pad only
    [
        /*p2*/ 0, 0, 1, 0, /*p3*/ 1, 0, 1, 0, /*p4*/ 1, 0, 1, 1,
    ], // 37: z > x > w > y
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 38: pad only
    [
        /*p2*/ 0, 0, 1, 0, /*p3*/ 1, 0, 1, 0, /*p4*/ 1, 1, 1, 0,
    ], // 39: z > x > y > w
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 40: pad only
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 41: pad only
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 42: pad only
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 43: pad only
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 44: pad only
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 45: pad only
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 46: pad only
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 47: pad only
    [
        /*p2*/ 0, 0, 0, 1, /*p3*/ 1, 0, 0, 1, /*p4*/ 1, 0, 1, 1,
    ], // 48: w > x > z > y
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 49: pad only
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 50: pad only
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 51: pad only
    [
        /*p2*/ 1, 0, 0, 0, /*p3*/ 1, 0, 0, 1, /*p4*/ 1, 0, 1, 1,
    ], // 52: x > w > z > y
    [
        /*p2*/ 1, 0, 0, 0, /*p3*/ 1, 0, 1, 0, /*p4*/ 1, 0, 1, 1,
    ], // 53: x > z > w > y
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 54: pad only
    [
        /*p2*/ 1, 0, 0, 0, /*p3*/ 1, 0, 1, 0, /*p4*/ 1, 1, 1, 0,
    ], // 55: x > z > y > w
    [
        /*p2*/ 0, 0, 0, 1, /*p3*/ 1, 0, 0, 1, /*p4*/ 1, 1, 0, 1,
    ], // 56: w > x > y > z
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 57: pad only
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 58: pad only
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 59: pad only
    [
        /*p2*/ 1, 0, 0, 0, /*p3*/ 1, 0, 0, 1, /*p4*/ 1, 1, 0, 1,
    ], // 60: x > w > y > z
    [
        /*p2*/ 0, 0, 0, 0, /*p3*/ 0, 0, 0, 0, /*p4*/ 0, 0, 0, 0,
    ], // 61: pad only
    [
        /*p2*/ 1, 0, 0, 0, /*p3*/ 1, 1, 0, 0, /*p4*/ 1, 1, 0, 1,
    ], // 62: x > y > w > z
    [
        /*p2*/ 1, 0, 0, 0, /*p3*/ 1, 1, 0, 0, /*p4*/ 1, 1, 1, 0,
    ], // 63: x > y > z > w
];
